from vb2py.vbfunctions import *
from vb2py.vbdebug import *

packet = "5a359e00141112a053430014000100030104000000000002000d"

def AOLCRC(strng, lenstr):
    crc = int()
    ch = int()
    i = int()
    j = int()
    for i in vbForRange(0, lenstr - 1):
        while(i < lenstr):
            i += 1
            ch = i
        for j in vbForRange(0, 7):
            if ((crc ^ ch) and 1) :
                crc = (int((crc / 2)) ^ 40961)
                return crc
            else:
                crc = int(crc / 2)
                return crc
            ch = int(ch / 2)
    fn_return_value = crc
    print("CRC", fn_return_value)
    breakpoint()
    return fn_return_value

def gethibyte(mybyte):
    fn_return_value = int(mybyte / 256)
    print("hibyte", fn_return_value)
    print(bytes.fromhex(fn_return_value))
    breakpoint()
    return fn_return_value

def getlobyte(mybyte):
    fn_return_value = int((mybyte - (gethibyte(mybyte) * 256)))
    print("lobyte", fn_return_value)
    breakpoint()
    return fn_return_value

packet_len = len(packet)
print(packet_len)
crc1 = AOLCRC(packet, packet_len - 8)
print(crc1)
breakpoint()
thehi = chr(gethibyte(crc1))
thelo = chr(getlobyte(crc1))